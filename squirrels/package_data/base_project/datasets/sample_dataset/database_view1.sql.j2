-- note: if context.py is defined, you can use "ctx['limit']" instead of "prms['number_example'].get_selected_value()"
SELECT dim1, avg(metric1) as metric1, avg(metric2) as metric2
FROM fact_table
WHERE metric1 <= {{ prms['upper_bound'].get_selected_value() }} 
GROUP BY dim1
